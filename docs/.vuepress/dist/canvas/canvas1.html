<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Canvas 进阶（一）二维码的生成与扫码识别 | 前端进阶小书</title>
    <meta name="description" content="小皮咖前端经验整理而写成的一本书">
    
    
    <link rel="preload" href="/Demo/advanced_front_end/assets/css/0.styles.eb11a0fb.css" as="style"><link rel="preload" href="/Demo/advanced_front_end/assets/js/app.cfdb2bbe.js" as="script"><link rel="preload" href="/Demo/advanced_front_end/assets/js/5.83a8ef12.js" as="script"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/10.dcc4a2a8.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/11.5a465fde.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/12.0e2732a2.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/13.b411a676.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/14.63492b16.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/15.d3ab2898.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/16.faa421a7.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/17.5a97bbc9.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/18.8c721c61.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/19.db1b27f3.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/2.ff3da7d2.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/20.3e3b44c3.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/21.82de92d8.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/22.b4b4fd3a.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/23.d13ced27.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/24.6a7de51f.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/25.30204664.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/26.a7bcccd9.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/27.f4bc556a.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/28.8beef1c0.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/29.89d7ed4c.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/3.3fe28852.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/30.09ee69b6.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/31.ca0bfc75.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/32.c8c0b6d1.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/33.33cc7d1d.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/34.e44af84a.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/35.7533d99a.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/36.fa39de9c.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/37.68e67712.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/38.f2921259.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/39.6f1cc1bf.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/4.6805f581.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/40.1624dcc5.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/6.0d2fbad0.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/7.3627c770.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/8.9bb33dc5.js"><link rel="prefetch" href="/Demo/advanced_front_end/assets/js/9.2cc8577a.js">
    <link rel="stylesheet" href="/Demo/advanced_front_end/assets/css/0.styles.eb11a0fb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Demo/advanced_front_end/" class="home-link router-link-active"><!----> <span class="site-name">前端进阶小书</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Demo/advanced_front_end/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/zxpsuper/advanced_front_end" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Demo/advanced_front_end/" class="nav-link">Home</a></div><div class="nav-item"><a href="https://github.com/zxpsuper/advanced_front_end" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>CSS 大全</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/css/cssTips.html" class="sidebar-link">CSS 几个小技巧</a></li><li><a href="/Demo/advanced_front_end/css/flex.html" class="sidebar-link">Flex布局介绍</a></li><li><a href="/Demo/advanced_front_end/css/css3.html" class="sidebar-link">CSS3 兼容性处理</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>算法与数据结构</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/suanfa/binarySearch.html" class="sidebar-link">算法复杂度</a></li><li><a href="/Demo/advanced_front_end/suanfa/sort.html" class="sidebar-link">排序算法</a></li><li><a href="/Demo/advanced_front_end/suanfa/dataStructure.html" class="sidebar-link">数据结构</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>浏览器相关</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/browser/https.html" class="sidebar-link">一个故事讲完https</a></li><li><a href="/Demo/advanced_front_end/browser/static.html" class="sidebar-link">静态资源缓存与更新</a></li><li><a href="/Demo/advanced_front_end/browser/cache.html" class="sidebar-link">协商缓存与强缓存</a></li><li><a href="/Demo/advanced_front_end/browser/cors.html" class="sidebar-link">跨域资源共享 CORS 详解</a></li><li><a href="/Demo/advanced_front_end/browser/eventloop.html" class="sidebar-link">浏览器 Event Loop 机制</a></li><li><a href="/Demo/advanced_front_end/browser/urlrender.html" class="sidebar-link">输入URL至页面渲染</a></li><li><a href="/Demo/advanced_front_end/browser/garbage.html" class="sidebar-link">浏览器内存回收机制</a></li><li><a href="/Demo/advanced_front_end/browser/garbagerefuse.html" class="sidebar-link">内存泄漏与避免</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Vue</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/vue/vue.html" class="sidebar-link">Vue 双向数据绑定原理</a></li><li><a href="/Demo/advanced_front_end/vue/router.html" class="sidebar-link">Vue-router 原理</a></li><li><a href="/Demo/advanced_front_end/vue/vueplugin.html" class="sidebar-link">Vue 编写一个长按指令插件</a></li><li><a href="/Demo/advanced_front_end/vue/vuedate.html" class="sidebar-link">vue 手写一个时间选择器</a></li><li><a href="/Demo/advanced_front_end/vue/computedvswatch.html" class="sidebar-link">Vue 中的 computed 与 watch 对比</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Javascript</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/js/use_strict.html" class="sidebar-link">Use Strict</a></li><li><a href="/Demo/advanced_front_end/js/amd_commonjs.html" class="sidebar-link">Javascript 模块化</a></li><li><a href="/Demo/advanced_front_end/js/seajs.html" class="sidebar-link">sea.js</a></li><li><a href="/Demo/advanced_front_end/js/design.html" class="sidebar-link">设计模式</a></li><li><a href="/Demo/advanced_front_end/js/regular_expression.html" class="sidebar-link">正则表达式</a></li><li><a href="/Demo/advanced_front_end/js/inherit.html" class="sidebar-link">继承的几种实现方式</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Canvas</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/canvas/canvas1.html" class="active sidebar-link">Canvas 进阶（一）二维码的生成与扫码识别</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Demo/advanced_front_end/canvas/canvas1.html#背景" class="sidebar-link">背景</a></li><li class="sidebar-sub-header"><a href="/Demo/advanced_front_end/canvas/canvas1.html#二维码的生成" class="sidebar-link">二维码的生成</a></li><li class="sidebar-sub-header"><a href="/Demo/advanced_front_end/canvas/canvas1.html#二维码扫码识别" class="sidebar-link">二维码扫码识别</a></li><li class="sidebar-sub-header"><a href="/Demo/advanced_front_end/canvas/canvas1.html#更多推荐" class="sidebar-link">更多推荐</a></li></ul></li><li><a href="/Demo/advanced_front_end/canvas/canvas2.html" class="sidebar-link">Canvas 进阶（二）写一个生成带logo的二维码npm插件</a></li><li><a href="/Demo/advanced_front_end/canvas/canvas3.html" class="sidebar-link">Canvas 进阶（三）ts + canvas 重写”辨色“小游戏</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>一些插件</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/plugin/carousal.html" class="sidebar-link">一款轮播组件的诞生</a></li><li><a href="/Demo/advanced_front_end/plugin/underscore.html" class="sidebar-link">如何写自己的 underscore</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/Demo/advanced_front_end/other/git.html" class="sidebar-link">GIT 操作总结</a></li><li><a href="/Demo/advanced_front_end/other/linux.html" class="sidebar-link">前端必备 linux 命令</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="canvas-进阶（一）二维码的生成与扫码识别"><a href="#canvas-进阶（一）二维码的生成与扫码识别" aria-hidden="true" class="header-anchor">#</a> Canvas 进阶（一）二维码的生成与扫码识别</h1> <h2 id="背景"><a href="#背景" aria-hidden="true" class="header-anchor">#</a> 背景</h2> <p>前些日子当前端面试官，问了一个问题：“你了解过canvas吗？”</p> <p>“这个我知道，我有做过DEMO，这个不难吧，看着它的api接口就能实现！”</p> <p>看着他这么（蜜汁）自信，我决定深入了解（为难）一下他！</p> <p>“电商中大转盘，九宫格，刮刮乐，如何使用canvas实现，讲讲你的思路？”</p> <p>“二维码的生成和扫码识别如何实现？”</p> <p>“图片的粒子爆炸效果呢？”</p> <p>“......”</p> <hr> <p>因此，打算写一系列关于 canvas 的文章，探索学习提升自己的同时顺便分享给大家。</p> <h2 id="二维码的生成"><a href="#二维码的生成" aria-hidden="true" class="header-anchor">#</a> 二维码的生成</h2> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAcwAAAFiCAYAAAB7zegYAAAbsklEQVR4Ae3df6he9X0H8M8Vq4ltY23aXs0IyzZ16R/R0AmuRSfBUif+M/tHIQsIFRwWgrUdQicSySitUNx0BCbIIghpwT9c/ymtpVassk5wRQ1j0WZtR7qY2zRVo/XXinec+ys3P3q/53nO/T7P93yf14Vi8pzz/Z7P9/U5t++c57nfZGp2dnY2fBEgQIAAAQIrCpy14lEHCRAgQIAAgTkBgelGIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAAYHpHiBAgAABAi0EBGYLJKcQIECAAAGB6R4gQIAAAQItBARmCySnECBAgAABgekeIECAAAECLQQEZgskpxAgQIAAgbNLJnjnnXfjlVePx5tvvR2zs7Mll6o2AkULTE1NxXlr18QFH1oX5557TtG1Ko5AqQJTs4UmUROW//vyr2L9hz8UH/zA++Oss6ZKNVQXgeIF3ntvNl5/47dx7Devxh9c9DGhWXzHFFiiQLGBeWTm17F27Zo4f90HSnRTE4FeCrx2/I14662348Lpj/SyfkUTGKdAsZ9hNm/DNk+WvggQWD2B5nuq+d7yRYDA4ALFBmbzTrG3YQdvqBEEVhJovqcK/RRmpbIdI1CEQNE/9FOEkCIITJDAC68fin/8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" alt></p> <p>二维码的生成需借助第三方库，利用其算法对文本转化成二维码，并用 <code>canvas</code> 绘画出来。利用 <code>canvas.toDataURL('image/png')</code> 获取二维码转 <code>base64</code> 值，再将其赋值给 <code>img</code> 标签的 <code>src</code> 属性</p> <p>这里我使用了一个库，<a href="https://github.com/davidshimjs/qrcodejs/" target="_blank" rel="noopener noreferrer">qrcodejs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>可点击 <a href="https://zxpsuper.github.io/Demo/qrcode/" target="_blank" rel="noopener noreferrer">《Demo》<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 查看效果</p> <p>使用方法如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>
<span class="token comment">&lt;!-- index.html --&gt;</span>
<span class="token doctype">&lt;!DOCTYPE html&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Suporka Vue App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
      <span class="token selector">.container</span> <span class="token punctuation">{</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 50px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">input</span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 32px<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 4px 7px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #dcdee2<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #515a6e<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
        <span class="token property">background-image</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
        <span class="token property">cursor</span><span class="token punctuation">:</span> text<span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> border 0.2s ease-in-out<span class="token punctuation">,</span> background 0.2s ease-in-out<span class="token punctuation">,</span>
          box-shadow 0.2s ease-in-out<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">button</span> <span class="token punctuation">{</span>
        <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
        <span class="token property">background-color</span><span class="token punctuation">:</span> #19be6b<span class="token punctuation">;</span>
        <span class="token property">border-color</span><span class="token punctuation">:</span> #19be6b<span class="token punctuation">;</span>
        <span class="token property">outline</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
        <span class="token property">vertical-align</span><span class="token punctuation">:</span> middle<span class="token punctuation">;</span>
        <span class="token property">line-height</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">font-weight</span><span class="token punctuation">:</span> 400<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">-ms-touch-action</span><span class="token punctuation">:</span> manipulation<span class="token punctuation">;</span>
        <span class="token property">touch-action</span><span class="token punctuation">:</span> manipulation<span class="token punctuation">;</span>
        <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
        <span class="token property">background-image</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">border</span><span class="token punctuation">:</span> 1px solid transparent<span class="token punctuation">;</span>
        <span class="token property">white-space</span><span class="token punctuation">:</span> nowrap<span class="token punctuation">;</span>
        <span class="token property">-webkit-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">-moz-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">-ms-user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">user-select</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
        <span class="token property">padding</span><span class="token punctuation">:</span> 5px 15px 6px<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
        <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
        <span class="token property">transition</span><span class="token punctuation">:</span> color 0.2s linear<span class="token punctuation">,</span> background-color 0.2s linear<span class="token punctuation">,</span>
          border 0.2s linear<span class="token punctuation">,</span> box-shadow 0.2s linear<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">#qrcode</span> <span class="token punctuation">{</span>
        <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
        <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>请输入您想转化成二维码的字符串<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>creatQRcode();<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>一键生成<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>qrcode<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://zxpsuper.github.io/Demo/qrcode/qrcode-dev.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token keyword">var</span> qrcode <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">function</span> <span class="token function">creatQRcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;qrcode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        qrcode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QRCode</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;qrcode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          text<span class="token punctuation">:</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">,</span>
          width<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          height<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
          colorDark<span class="token punctuation">:</span> <span class="token string">&quot;#000000&quot;</span><span class="token punctuation">,</span>
          colorLight<span class="token punctuation">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>
          correctLevel<span class="token punctuation">:</span> QRCode<span class="token punctuation">.</span>CorrectLevel<span class="token punctuation">.</span><span class="token constant">H</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br></div></div><p><strong>options</strong></p> <ul><li>首参为生成存放 <code>img</code> 标签的父元素</li> <li>第二个参数为 <code>Object</code>  类型的 <code>options</code></li></ul> <table><thead><tr><th style="text-align:center">属性</th> <th style="text-align:center">类型</th> <th style="text-align:center">说明</th></tr></thead> <tbody><tr><td style="text-align:center">text</td> <td style="text-align:center">String</td> <td style="text-align:center">目标文本</td></tr> <tr><td style="text-align:center">width</td> <td style="text-align:center">Number</td> <td style="text-align:center">图片宽度</td></tr> <tr><td style="text-align:center">height</td> <td style="text-align:center">Number</td> <td style="text-align:center">图片高度</td></tr> <tr><td style="text-align:center">colorDark</td> <td style="text-align:center">String</td> <td style="text-align:center">二维码颜色</td></tr> <tr><td style="text-align:center">colorLight</td> <td style="text-align:center">默认QRCode.CorrectLevel.L</td> <td style="text-align:center">容错级别，可设置为：QRCode.CorrectLevel.L ，QRCode.CorrectLevel.M，QRCode.CorrectLevel.Q，QRCode.CorrectLevel.H</td></tr></tbody></table> <h2 id="二维码扫码识别"><a href="#二维码扫码识别" aria-hidden="true" class="header-anchor">#</a> 二维码扫码识别</h2> <p>这里利用了一个库 <a href="https://github.com/zxpsuper/Demo/blob/master/qrcode/llqrcode.js" target="_blank" rel="noopener noreferrer">llqrcode.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, 使用 <code>qrcode.decode()</code> 对 id 为 <code>qr-canvas</code> 的 <code>canvas</code> 进行解码.</p> <p>先上 <a href="https://zxpsuper.github.io/Demo/qrcode/qrcode-scan.html" target="_blank" rel="noopener noreferrer">Demo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://github.com/zxpsuper/Demo/blob/master/qrcode" target="_blank" rel="noopener noreferrer">项目源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>我们需要做的就是，调用设备的摄像头（后置摄像头优先），获得的画面用 <code>video</code> 标签实时显示出来，再定时取画面生成 canvas ，调用 <code>qrcode.decode()</code> 解密。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// variable.js</span>
<span class="token keyword">var</span> gCtx <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">//canvas.ctx</span>
<span class="token keyword">var</span> gCanvas <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// qr-canvas</span>
<span class="token comment">// var c = 0;</span>
<span class="token keyword">var</span> stype <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 识别流程 0未开始 1进行中 2已结束</span>
<span class="token keyword">var</span> gUM <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> webkit <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> moz <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 存放视频的变量</span>
<span class="token keyword">var</span> scanCodeStart <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 开始扫码</span>
<span class="token keyword">var</span> mediaStreamTrack <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// mediaStreamTrack 实现关闭摄像头功能 mediaStreamTrack.stop()</span>
<span class="token keyword">var</span> imghtml <span class="token operator">=</span>
  <span class="token string">'&lt;div id=&quot;qrfile&quot;&gt;&lt;canvas id=&quot;out-canvas&quot; width=&quot;320&quot; height=&quot;240&quot;&gt;&lt;/canvas&gt;'</span> <span class="token operator">+</span>
  <span class="token string">'&lt;div id=&quot;imghelp&quot;&gt;drag and drop a QRCode here'</span> <span class="token operator">+</span>
  <span class="token string">&quot;&lt;br&gt;or select a file&quot;</span> <span class="token operator">+</span>
  <span class="token string">'&lt;input type=&quot;file&quot; onchange=&quot;handleFiles(this.files)&quot; id=&quot;upload-img&quot;/&gt;'</span> <span class="token operator">+</span>
  <span class="token string">&quot;&lt;/div&gt;&quot;</span> <span class="token operator">+</span>
  <span class="token string">&quot;&lt;/div&gt;&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> vidhtml <span class="token operator">=</span> <span class="token string">'&lt;video id=&quot;v&quot; autoplay muted&gt;&lt;/video&gt;'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// methods.js</span>

<span class="token keyword">function</span> <span class="token function">qrcodeScanLoad</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token punctuation">,</span> height</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isCanvasSupported</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>File <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>FileReader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">initCanvas</span><span class="token punctuation">(</span>width<span class="token punctuation">,</span> height<span class="token punctuation">)</span><span class="token punctuation">;</span>
    qrcode<span class="token punctuation">.</span>callback <span class="token operator">=</span> scanCodeCallback<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;mainbody&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;inline&quot;</span><span class="token punctuation">;</span>
    <span class="token function">setwebcam</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;mainbody&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;inline&quot;</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;mainbody&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span>
      <span class="token string">'&lt;p id=&quot;mp1&quot;&gt;QR code scanner for HTML5 capable browsers&lt;/p&gt;&lt;br&gt;'</span> <span class="token operator">+</span>
      <span class="token string">'&lt;br&gt;&lt;p id=&quot;mp2&quot;&gt;sorry your browser is not supported&lt;/p&gt;&lt;br&gt;&lt;br&gt;'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 绘制遮罩层canvas</span>
<span class="token keyword">function</span> <span class="token function">setMask</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#scancode-mask&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>width <span class="token operator">=</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth <span class="token operator">&gt;</span> <span class="token number">1024</span> <span class="token operator">?</span> <span class="token number">1024</span> <span class="token punctuation">:</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
  canvas<span class="token punctuation">.</span>height <span class="token operator">=</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth <span class="token operator">&gt;</span> <span class="token number">1024</span> <span class="token operator">?</span> <span class="token number">1136</span> <span class="token punctuation">:</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
  <span class="token keyword">var</span> ctx <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">&quot;destination-out&quot;</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">beginPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> x1<span class="token punctuation">,</span>
    y1<span class="token punctuation">,</span>
    width <span class="token operator">=</span> canvas<span class="token punctuation">.</span>width <span class="token operator">*</span> <span class="token number">0.6</span><span class="token punctuation">;</span>
  x1 <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>width <span class="token operator">-</span> width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  y1 <span class="token operator">=</span> <span class="token punctuation">(</span>canvas<span class="token punctuation">.</span>height <span class="token operator">-</span> width<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> width<span class="token punctuation">,</span> width<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">fill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">&quot;source-over&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">// 第二象限点</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 第一象限点</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width<span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 第四象限点</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width<span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 第三象限点</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">20</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">moveTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">lineTo</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">,</span> y1 <span class="token operator">+</span> width <span class="token operator">-</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>lineWidth <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span>strokeStyle <span class="token operator">=</span> <span class="token string">&quot;green&quot;</span><span class="token punctuation">;</span>
  ctx<span class="token punctuation">.</span><span class="token function">stroke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">setwebcam</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> options <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>navigator<span class="token punctuation">.</span>mediaDevices <span class="token operator">&amp;&amp;</span> navigator<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span>enumerateDevices<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      navigator<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span><span class="token function">enumerateDevices</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">devices</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> video <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        devices<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">device</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>device<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">&quot;videoinput&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            video<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>device<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 调用设备的摄像头，video[1] 为后置摄像头，或者label含有‘back’为后置摄像头</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>video<span class="token punctuation">.</span>length <span class="token operator">&gt;=</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          options <span class="token operator">=</span> <span class="token punctuation">{</span>
            deviceId<span class="token punctuation">:</span> <span class="token punctuation">{</span> exact<span class="token punctuation">:</span> video<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>deviceId <span class="token punctuation">}</span><span class="token punctuation">,</span>
            facingMode<span class="token punctuation">:</span> <span class="token punctuation">{</span> exact<span class="token punctuation">:</span> <span class="token string">&quot;environment&quot;</span> <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        video<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>label<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span><span class="token string">&quot;back&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            options <span class="token operator">=</span> <span class="token punctuation">{</span>
              deviceId<span class="token punctuation">:</span> <span class="token punctuation">{</span> exact<span class="token punctuation">:</span> device<span class="token punctuation">.</span>deviceId <span class="token punctuation">}</span><span class="token punctuation">,</span>
              facingMode<span class="token punctuation">:</span> <span class="token punctuation">{</span> exact<span class="token punctuation">:</span> <span class="token string">&quot;environment&quot;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        scanCodeStart <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token function">setwebcam2</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;no navigator.mediaDevices.enumerateDevices&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">setwebcam2</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">setwebcam2</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>stype <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>captureToCanvas<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> n <span class="token operator">=</span> navigator<span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;outdiv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> vidhtml<span class="token punctuation">;</span>
  v <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;v&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>mediaDevices <span class="token operator">&amp;&amp;</span> n<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span>getUserMedia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      n<span class="token punctuation">.</span>mediaDevices
        <span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> video<span class="token punctuation">:</span> options<span class="token punctuation">,</span> audio<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">success</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>getUserMedia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      webkit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      n<span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> video<span class="token punctuation">:</span> options<span class="token punctuation">,</span> audio<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> success<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>webkitGetUserMedia<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      webkit <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      n<span class="token punctuation">.</span><span class="token function">webkitGetUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> video<span class="token punctuation">:</span> options<span class="token punctuation">,</span> audio<span class="token punctuation">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> success<span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  stype <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;ios&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您的設備暫不支持實時掃碼，請上傳圖片識別！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    <span class="token punctuation">(</span>n<span class="token punctuation">.</span>mediaDevices <span class="token operator">&amp;&amp;</span> n<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span>getUserMedia<span class="token punctuation">)</span> <span class="token operator">||</span>
    n<span class="token punctuation">.</span>getUserMedia <span class="token operator">||</span>
    n<span class="token punctuation">.</span>webkitGetUserMedia
  <span class="token punctuation">)</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>captureToCanvas<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;您的設備暫不支持實時掃碼，請上傳圖片識別！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取操作系统</span>
<span class="token keyword">function</span> <span class="token function">getSystem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> u <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">;</span>
  <span class="token keyword">var</span> isAndroid <span class="token operator">=</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;Android&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">||</span> u<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;Linux&quot;</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//g</span>
  <span class="token keyword">var</span> isIOS <span class="token operator">=</span> <span class="token operator">!</span><span class="token operator">!</span>u<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ios终端</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>isAndroid<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//这个是安卓操作系统</span>
    <span class="token keyword">return</span> <span class="token string">&quot;android&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>isIOS<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//这个是ios操作系统</span>
    <span class="token keyword">return</span> <span class="token string">&quot;ios&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;other&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 选择图片上传</span>
<span class="token keyword">function</span> <span class="token function">setimg</span><span class="token punctuation">(</span><span class="token parameter">$event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  qrcode<span class="token punctuation">.</span>callback <span class="token operator">=</span> scanCodeCallback<span class="token punctuation">;</span>
  $event <span class="token operator">&amp;&amp;</span> $event<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  stype <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> file <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;upload-img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  file<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 上传成功的回调</span>
<span class="token keyword">function</span> <span class="token function">scanCodeCallback</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> html <span class="token operator">=</span> <span class="token function">htmlEntities</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
  stype <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>html<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 处理上传文件识别</span>
<span class="token keyword">function</span> <span class="token function">handleFiles</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> f<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> reader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span>onload <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">theFile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        gCtx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> gCanvas<span class="token punctuation">.</span>width<span class="token punctuation">,</span> gCanvas<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
        qrcode<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    reader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">initCanvas</span><span class="token punctuation">(</span><span class="token parameter">w<span class="token punctuation">,</span> h</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gCanvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;qr-canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gCanvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> w <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
  gCanvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> h <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
  gCanvas<span class="token punctuation">.</span>width <span class="token operator">=</span> w<span class="token punctuation">;</span>
  gCanvas<span class="token punctuation">.</span>height <span class="token operator">=</span> h<span class="token punctuation">;</span>
  gCtx <span class="token operator">=</span> gCanvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  gCtx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> w<span class="token punctuation">,</span> h<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 画面转 canvas</span>
<span class="token keyword">function</span> <span class="token function">captureToCanvas</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>stype <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>gUM <span class="token operator">&amp;&amp;</span> scanCodeStart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      gCtx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        qrcode<span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 默认为id=qr-canvas的canvas转成图片的base64</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span>captureToCanvas<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span>captureToCanvas<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 对特殊符号进行处理</span>
<span class="token keyword">function</span> <span class="token function">htmlEntities</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">String</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&amp;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;amp;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&lt;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;lt;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&gt;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;gt;&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/&quot;/g</span><span class="token punctuation">,</span> <span class="token string">&quot;&amp;quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断是否支持canvas</span>
<span class="token keyword">function</span> <span class="token function">isCanvasSupported</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> elem <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">!</span><span class="token operator">!</span><span class="token punctuation">(</span>elem<span class="token punctuation">.</span>getContext <span class="token operator">&amp;&amp;</span> elem<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">stream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// mediaStreamTrack 实现关闭摄像头功能</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>stream<span class="token punctuation">)</span>
    mediaStreamTrack <span class="token operator">=</span>
      <span class="token keyword">typeof</span> stream<span class="token punctuation">.</span>stop <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span> stream <span class="token punctuation">:</span> stream<span class="token punctuation">.</span><span class="token function">getTracks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  v<span class="token punctuation">.</span>srcObject <span class="token operator">=</span> stream<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>scanCodeStart<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    v<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    gUM <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>captureToCanvas<span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  gUM <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br></div></div><p>其中 setMask 为绘制遮罩层方法，qrcodeScanLoad 为初始化加载方法。</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>mainbody<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> inline<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>outdiv<span class="token punctuation">&quot;</span></span> <span class="token attr-name">autoplay</span> <span class="token attr-name">muted</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>qr-canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>800<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scancode-mask<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scancode-tips-group<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>scancode-tips-group<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tips<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>將QR Code 放入框内，即可自動掃描<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>upload-my-code<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>setimg()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我的QR Code<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>img-upload-container<span class="token punctuation">&quot;</span></span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">display</span><span class="token punctuation">:</span> none</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>qrfile<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>out-canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>320<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>240<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>imghelp<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            drag and drop a QRCode here
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span> <span class="token punctuation">/&gt;</span></span>or select a file
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
              <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">onchange</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>handleFiles(this.files)<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>upload-img<span class="token punctuation">&quot;</span></span>
            <span class="token punctuation">/&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./llqrcode.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./variable.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>./methods.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
      <span class="token function">qrcodeScanLoad</span><span class="token punctuation">(</span><span class="token number">320</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">setMask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 对我的 QR Code 进行定位显示</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth <span class="token operator">&lt;</span> <span class="token number">1025</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;scancode-tips-group&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span>
          <span class="token punctuation">(</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientHeight <span class="token operator">-</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span> <span class="token operator">+</span>
          document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth <span class="token operator">*</span> <span class="token number">0.9</span> <span class="token operator">-</span>
          <span class="token number">10</span> <span class="token operator">+</span>
          <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;scancode-tips-group&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">&quot;720px&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>这里做了适配，当超过 1024 时，canvas 宽度就设为 1024。详细在代码中已经做了注释。</p> <h2 id="更多推荐"><a href="#更多推荐" aria-hidden="true" class="header-anchor">#</a> 更多推荐</h2> <p><a href="https://github.com/zxpsuper/advanced_front_end" target="_blank" rel="noopener noreferrer">前端进阶小书（advanced_front_end）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://github.com/zxpsuper/daily-question" target="_blank" rel="noopener noreferrer">前端每日一题（daily-question）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><a href="https://github.com/zxpsuper/createVue" target="_blank" rel="noopener noreferrer">webpack4 搭建 Vue 应用（createVue）<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="https://user-gold-cdn.xitu.io/2019/4/23/16a483433ed83578?w=281&h=271&f=png&s=29836" alt></p></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/Demo/advanced_front_end/js/inherit.html" class="prev">
          继承的几种实现方式
        </a></span> <span class="next"><a href="/Demo/advanced_front_end/canvas/canvas2.html">
          Canvas 进阶（二）写一个生成带logo的二维码npm插件
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/Demo/advanced_front_end/assets/js/app.cfdb2bbe.js" defer></script><script src="/Demo/advanced_front_end/assets/js/5.83a8ef12.js" defer></script>
  </body>
</html>
